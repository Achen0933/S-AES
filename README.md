# S-AES
TiMi小组S-AES实现
# TiMi小组S-AES1-5关测试结果

成员：戴静、陈晓阳

## **第1关：基本测试**

本小组GUI主界面如下：

![](./image1.png){width="3.4583333333333335in"
height="2.8722222222222222in"}

![](./image2.png){width="3.4625in" height="2.8694444444444445in"}

输入部分：加密选项卡输入16-bit的密钥、16-bit的明文（ASCII编码明文详见第3关）；

解密选项卡输入加密选项卡输入16-bit的密钥、16-bit的密文（和ASCII编码密文）。

输出结果：加密选项卡输入密钥和明文后点击加密，文本框显示加密后的密文；解密选项卡输入密钥和密文后点击解密，文本框显示解密后的明文。

![](./image3.png){width="3.529861111111111in"
height="2.901388888888889in"}

![](./image4.png){width="3.5368055555555555in"
height="2.9520833333333334in"}

由上两图可见，加密前的明文和解密后的明文保持一致，说明加解密过程无误。第1关测试完成。

## **第2关：交叉测试**

本小组与窦一冉组、鲁梦瑶组、唐豪组进行交叉测试。

测试明文：1111000011110000

测试密钥：1100111101011100

本组结果：

![12343b3b390dd9a14c35c0f0c167b0a](./image5.png){width="3.1944444444444446in"
height="2.6333333333333333in"}

![998ea6e7d1302932d75ea34536edc4d](./image6.png){width="3.20625in"
height="2.6631944444444446in"}

窦一冉组结果（加密）：

![01789b1e38127181f8301ec67a7ee8d](./image7.jpeg){width="3.079861111111111in"
height="3.571527777777778in"}

鲁梦瑶组结果（解密）：

![72247a13a4c0a16677e1cea372db61c](./image8.png){width="4.232638888888889in"
height="2.76875in"}

唐豪组结果（加密）：

![IMG_256](./image9.jpeg){width="4.263194444444444in"
height="3.2152777777777777in"}

由上面四组加密结果截图可见，加密后密文均为1001000101100100，解密后明文仍为1111000011110000，符合交叉测试的通过要求。第2关测试完成。

## **第3关：扩展功能**

考虑到向实用性扩展，加密算法的数据输入可以是ASII编码字符串(分组为2
Bytes)，对应地输出也可以是ASCII字符串(很可能是乱码)。本组成功实现了该扩展功能，具体方法如下：将ASCII字符串转化为二进制字符串，并以2
Bytes为一组对该二进制字符串进行循环加密，得到加密后的二进制字符串密文。随后将二进制字符串密文重新转化为ASCII字符串输出。解密同理。

输入部分：加密选项卡输入16-bit的密钥和ASCII编码明文；

解密选项卡输入加密选项卡输入16-bit的密钥和ASCII编码密文。

输出结果：加密选项卡输入密钥和ASCII明文后点击加密，文本框显示加密后的ASCII密文；解密选项卡输入密钥和ASCII密文后点击解密，文本框显示解密后的ASCII明文。

![](./image10.png){width="3.6125in" height="3.009027777777778in"}

![](./image11.png){width="3.60625in" height="2.990972222222222in"}

由上两图可见，加密前的明文和解密后的明文保持一致，说明加解密过程无误。第3关测试完成。

**综合第1关和第3关，本组的GUI实现了普通16-bit二进制字符串和ASCII编码字符串的同时加\\解密，并可以同时显示加\\解密结果。效果如下：**

![](./image12.png){width="3.529166666666667in"
height="2.895138888888889in"}

![](./image13.png){width="3.526388888888889in"
height="2.910416666666667in"}

## **第4关：多重加密**

**4.1 双重加密**

将S-AES算法通过双重加密进行扩展，分组长度仍然是16 bits，但密钥长度为32
bits。

本组使用Key(K1+K2)的32-bit密钥，使用两重encryption函数进行双重加密，效果如下：

![8f8ad283895e517414a92181d38fc07](./image14.png){width="5.534722222222222in"
height="2.1944444444444446in"}

**4.2 中间相遇攻击**

我们使用已知的使用相同密钥的明、密文对(一个或多个)，使用中间相遇攻击的方法进行暴力破解，找到所有正确的密钥Key(K1+K2)。以下是一个示例：

已知明文known_plaintext = \"0000111100001111\"\
已知密文known_ciphertext = \"1001110100000000\"

由截图可见中间相遇攻击可以找到多个可能的密钥，截图为暴力破解运行部分截图：

![cb08d51025c7723bf0548faa57665c4](./image15.png){width="5.766666666666667in"
height="1.9402777777777778in"}

![9a13f4f7749295356fc46c062d6d627](./image16.png){width="5.7652777777777775in"
height="2.057638888888889in"}

由图可见，k1外循环进行到一半左右，已生成276个可能的密钥。完整密钥过于冗余，此处不进行展示。

任选一个可能的密钥进行验证，加解密成功。

![](./image17.png){width="5.757638888888889in"
height="1.7993055555555555in"}

**4.3 三重加密**

将S-AES算法通过三重加密进行扩展，本组选择"按照32
bits密钥Key(K1+K2)的模式进行三重加密解密"的模式进行加解密，原理如下：

![1e75c3bb6031d7657468f65ba1e9a6f](./image18.png){width="2.4659722222222222in"
height="1.1277777777777778in"}

加解密效果如下：

![3a6153211b35a3726d4b61508a0a2d3](./image19.png){width="4.444444444444445in"
height="2.173611111111111in"}

第4关测试完成。

## **第5关：工作模式**

本组编写了在CBC模式下进行加解密的算法，并尝试对密文分组进行替换或修改，然后进行解密。

加解密效果如下：

![a679fa497b43afdd27a01986b3bc1b6](./image20.png){width="4.395833333333333in"
height="2.7777777777777777in"}

对比篡改密文前后的解密结果可以发现并不相同。第5关测试完成。

# TiMi小组关于S-AES加解密项目开发手册

## **一、概述**

本项目可通过GUI界面实现对二进制、ASCII编码的数据进行加/解密，此外还可以实现双重加密、三重加密以及CBC加/解密，中间相遇攻击（即暴力破解）。

## **二、GUI界面**

**2.1 相关代码**

GUI界面相关代码可参考代码项目中GUI.py相关文件。

**2.2 具体界面及操作解释**

用户可以通过运行GUI.py文件可得：

![](./image1.png){width="4.243273184601925in"
height="3.618241469816273in"}

用户输入16位二进制的明/密文以及ASCII码值，可进行加/解密：

![](./image2.png){width="4.215494313210849in"
height="3.646020341207349in"}

![](./image3.png){width="4.229384295713036in"
height="3.590462598425197in"}

若输入密钥或者明文的长度、格式不对（比如密钥长度不为16，二进制明文长度不为16，或者格式不为二进制），会有相关提醒：

![](./image4.png){width="4.180769903762029in"
height="3.583517060367454in"}

![](./image5.png){width="4.152991032370954in"
height="3.583517060367454in"}

![](./image6.png){width="4.187715441819773in"
height="3.583517060367454in"}

双重加密/三重加密：

双重加密采用ppt上第一种加/解密方式：

![](./image7.png){width="5.534722222222222in"
height="2.1944444444444446in"}

三重加密采用{k1, k2}模式：

![](./image8.png){width="4.444444444444445in"
height="2.173611111111111in"}

CBC加/解密：其中可发现小小的篡改密文后引来变化也是很大

![](./image1.png){width="4.395833333333333in"
height="2.7777777777777777in"}

中间相遇攻击：

选定一对明密文，进行中间相遇攻击，虽运行速度较慢，但最终仍可找到相应的密钥

![](./image2.png){width="5.768055555555556in"
height="1.9409722222222223in"}

## **三、项目代码部分相关介绍**

![](./image3.png){width="3.2569444444444446in"
height="2.8055555555555554in"}

其中GUI.py主要关于界面与函数接口等的融合；function.py主要设计轮密钥加、行位移、列混淆、S-box等的设计；key.py主要设计了密钥扩展；encryption.py主要完成加密过程；decryption.py主要完成解密过程；ASCII.py完成了对于ASCII编码的加/解密；mid-meet-attack.py完成了中间相遇攻击；tribble_aes.py，double_aes.py，cbc_aes.py分别是关于三重加/解密、双重加/解密、CBC对长明/密文加/解密。

可运行文件为：GUI.py；tribble_aes.py，double_aes.py，cbc_aes.py，mid-meet-attack.py文件

## **四、项目背景介绍**

S-AES算法加/解密原理流程图如下：

![](./image4.png){width="5.340552274715661in"
height="3.8404746281714788in"}

S-AES流程如下：

![](./image5.png){width="4.014095581802275in"
height="3.8543646106736658in"}

密钥扩展：

![](./image6.png){width="3.1459951881014874in"
height="3.7363035870516184in"}

## **五、实验步骤**

●运行GUI.py文件

●可选择"加密"或者"解密"选项

●输入相应的密钥，二进制明/密文（可选），ASCII编码的明/密文（可选），选择加/解密

●若进行双重/三重/CBC加/解密，可运行tribble_aes.py，double_aes.py，cbc_aes.py，mid-meet-attack.py文件

●运行mid-meet-attack.py文件即可进行中间相遇攻击（但注意暴力破解由于是十六进制，运行时间较长，请谨慎使用）

## **六、其他帮助**

TiMi小组是一个优秀的团队，且热情负责。若您在使用过程中出现任何困惑不解，[[可发送邮件至891073279@qq.com]{.underline}](mailto:可发送邮件至891073279@qq.com)或者3416924346@qq.com。

